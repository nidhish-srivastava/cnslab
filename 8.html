<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Diffie Hellman</title>
</head>
<body>
<h1>Diffie-Hellman</h1>
<label for="p">Enter p: </label>
<input type="number" id="p" required><br><br>
<label for="a">Enter a: </label>
<input type="number" id="a" required><br><br>
<label for="alicePri">Enter alice's priv key: </label>
<input type="number" id="x1" required><br><br>
<label for="bobPri">Enter bob's priv key: </label>
<input type="number" id="x2" required><br><br>

<button onclick="generateKeys()">Generate Keys</button>

<div id="output"></div>

<script>
    function generateKeys(){
            const p=parseInt(document.getElementById('p').value);
            const a=parseInt(document.getElementById('a').value);
            const x1=parseInt(document.getElementById('x1').value);
            const x2=parseInt(document.getElementById('x2').value);

            const y1 = BigInt(a) ** BigInt(x1) % BigInt(p);
            const y2 = BigInt(a) ** BigInt(x2) % BigInt(p);

            const shared_a = BigInt(y2) ** BigInt(x1) % BigInt(p);
            const shared_b = BigInt(y1) ** BigInt(x2) % BigInt(p);

            document.getElementById('output').innerHTML=`
            <p>Alice's public key: ${y1}</p>
            <p>Bob's public key: ${y2}</p>
            <p>Shared secret key of Alice: ${shared_a}</p>
            <p>Shared secret key of Bob: ${shared_b}</p>
            `;
        }
</script>
</body>
</html>